# Linux 性能优化
---
- [# Linux 性能优化](#h1-id%22linux-e680a7e883bde4bc98e58c96-61%22linux-%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96h1)

---

- 性能优化的核心：找出瓶颈
- 性能优化的层面：系统层面，应用层面

# 分析瓶颈
- 系统瓶颈
  - IO瓶颈
  - CPU瓶颈
  - 内存瓶颈
  - 程序导致系统问题
- top: 各进程对资源的使用
- free: 内存使用
- vmstat: 动态监视内存变化
- iostat: 
- pstack: 跟踪进程栈
- pstrace: 跟踪进程中的系统调用


# 优化程序代码
- 二八原则：将精力集中在20%最耗时的代码上（优化重复执行的少部分代码）
- 编完代码再优化
  - 编码时考虑的最佳性能未必最佳
  - 强调最佳性能的编码可能损失代码的可读性和开发效率
- gprof工具
  - gcc的-pg编译选项：自动插入性能测试代码，记录运行时函数调用关系、次数、时间
  - gprof命令分析记录程序运行信息的gmon.out文件
- valgrind: 内存泄漏
- OProfile
- sar